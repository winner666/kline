"use strict";!function(e,t){"function"==typeof define&&(define.amd||define.cmd)?define(t):e.touch=t()}(this,function(){var e={};e.PCevts={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseout"},e.hasTouch="ontouchstart"in window,e.getType=function(e){return Object.prototype.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},e.getSelector=function(e){return e.id?"#"+e.id:e.className?"."+e.className.split(/\s+/).join("."):e===document?"body":e.tagName.toLowerCase()},e.matchSelector=function(e,t){return e.webkitMatchesSelector(t)},e.getEventListeners=function(e){return e.listeners},e.getPCevts=function(e){return this.PCevts[e]||e},e.forceReflow=function(){var e="reflowDivBlock",t=document.getElementById(e);t||(t=document.createElement("div"),t.id=e,document.body.appendChild(t));var n=t.parentNode,r=t.nextSibling;n.removeChild(t),n.insertBefore(t,r)},e.simpleClone=function(e){return Object.create(e)},e.getPosOfEvent=function(e){if(this.hasTouch){for(var t=[],n=null,r=0,i=e.touches.length;i>r;r++)n=e.touches[r],t.push({x:n.pageX,y:n.pageY});return t}return[{x:e.pageX,y:e.pageY}]},e.getDistance=function(e,t){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)},e.getFingers=function(e){return e.touches?e.touches.length:1},e.calScale=function(e,t){if(e.length>=2&&t.length>=2){var n=this.getDistance(e[1],e[0]);return this.getDistance(t[1],t[0])/n}return 1},e.getAngle=function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI},e.getAngle180=function(e,t){var n=Math.atan(-1*(t.y-e.y)/(t.x-e.x))*(180/Math.PI);return 0>n?n+180:n},e.getDirectionFromAngle=function(e){var t={up:-45>e&&e>-135,down:e>=45&&135>e,left:e>=135||-135>=e,right:e>=-45&&45>=e};for(var n in t)if(t[n])return n;return null},e.getXYByElement=function(e){for(var t=0,n=0;e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},e.reset=function(){s=a=c=null,v=h=u=g=!1,l=!1,i={},T=!1},e.isTouchMove=function(e){return"touchmove"===e.type||"mousemove"===e.type},e.isTouchEnd=function(e){return"touchend"===e.type||"mouseup"===e.type||"touchcancel"===e.type},e.env=function(){var e={},t=navigator.userAgent,n=t.match(/(Android)[\s\/]+([\d\.]+)/),r=t.match(/(iPad|iPhone|iPod)\s+OS\s([\d_\.]+)/),i=t.match(/(Windows\s+Phone)\s([\d\.]+)/),o=/WebKit\/[\d.]+/i.test(t),s=!!r&&(navigator.standalone?o:/Safari/i.test(t)&&!/CriOS/i.test(t)&&!/MQQBrowser/i.test(t));return n&&(e.android=!0,e.version=n[2]),r&&(e.ios=!0,e.version=r[2].replace(/_/g,"."),e.ios7=/^7/.test(e.version),"iPad"===r[1]?e.ipad=!0:"iPhone"===r[1]?(e.iphone=!0,e.iphone5=568==screen.height):"iPod"===r[1]&&(e.ipod=!0)),i&&(e.wp=!0,e.version=i[2],e.wp8=/^8/.test(e.version)),o&&(e.webkit=!0),s&&(e.safari=!0),e}();var t={proxyid:0,proxies:[],trigger:function(e,t,n){var r,i={bubbles:!0,cancelable:!0,detail:n=n||{}};try{"undefined"!=typeof CustomEvent?(r=new CustomEvent(t,i),e&&e.dispatchEvent(r)):((r=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,n),e&&e.dispatchEvent(r))}catch(e){console.warn("Touch.js is not supported by environment.")}},bind:function(t,n,r){t.listeners=t.listeners||{},t.listeners[n]?t.listeners[n].push(r):t.listeners[n]=[r];var i=function(t){e.env.ios7&&e.forceReflow(),t.originEvent=t;for(var n in t.detail)"type"!==n&&(t[n]=t.detail[n]);t.startRotate=function(){T=!0};var i=r.call(t.target,t);void 0===i||i||(t.stopPropagation(),t.preventDefault())};r.proxy=r.proxy||{},r.proxy[n]?r.proxy[n].push(this.proxyid++):r.proxy[n]=[this.proxyid++],this.proxies.push(i),t.addEventListener&&t.addEventListener(n,i,!1)},unbind:function(e,t,n){if(n){var r=n.proxy[t];r&&r.length&&r.forEach(function(){e.removeEventListener&&e.removeEventListener(t,this.proxies[this.proxyid],!1)})}else{var i=e.listeners[t];i&&i.length&&i.forEach(function(n){e.removeEventListener(t,n,!1)})}},delegate:function(t,n,r,i){var o=function(n){var o,s;n.originEvent=n;for(var a in n.detail)"type"!==a&&(n[a]=n.detail[a]);n.startRotate=function(){T=!0};var c=e.getSelector(t)+" "+r,u=e.matchSelector(n.target,c),g=e.matchSelector(n.target,c+" "+n.target.nodeName);if(!u&&g){for(e.env.ios7&&e.forceReflow(),o=n.target;!e.matchSelector(o,c);)o=o.parentNode;void 0===(s=i.call(n.target,n))||s||(n.stopPropagation(),n.preventDefault())}else e.env.ios7&&e.forceReflow(),(u||g)&&(void 0===(s=i.call(n.target,n))||s||(n.stopPropagation(),n.preventDefault()))};i.proxy=i.proxy||{},i.proxy[n]?i.proxy[n].push(this.proxyid++):i.proxy[n]=[this.proxyid++],this.proxies.push(o),t.listeners=t.listeners||{},t.listeners[n]?t.listeners[n].push(o):t.listeners[n]=[o],t.addEventListener&&t.addEventListener(n,o,!1)},undelegate:function(e,t,n,r){if(r){var i=r.proxy[t];i.length&&i.forEach(function(){e.removeEventListener&&e.removeEventListener(t,this.proxies[this.proxyid],!1)})}else e.listeners[t].forEach(function(n){e.removeEventListener(t,n,!1)})}},n={tap:!0,doubleTap:!0,tapMaxDistance:10,hold:!0,tapTime:200,holdTime:650,maxDoubleTapInterval:300,swipe:!0,swipeTime:300,swipeMinDistance:18,swipeFactor:5,drag:!0,pinch:!0,minScaleRate:0,minRotationAngle:0},r={TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_UP:"mouseup",CLICK:"click",PINCH_START:"pinchstart",PINCH_END:"pinchend",PINCH:"pinch",PINCH_IN:"pinchin",PINCH_OUT:"pinchout",ROTATION_LEFT:"rotateleft",ROTATION_RIGHT:"rotateright",ROTATION:"rotate",SWIPE_START:"swipestart",SWIPING:"swiping",SWIPE_END:"swipeend",SWIPE_LEFT:"swipeleft",SWIPE_RIGHT:"swiperight",SWIPE_UP:"swipeup",SWIPE_DOWN:"swipedown",SWIPE:"swipe",DRAG:"drag",DRAGSTART:"dragstart",DRAGEND:"dragend",HOLD:"hold",TAP:"tap",DOUBLE_TAP:"doubletap"},i={start:null,move:null,end:null},o=0,s=null,a=null,c=null,u=!1,g=!1,l=!1,f={},h=!1,p=null,v=!1,d=null,m=1,T=!1,E=[],y=0,P=0,w=0,S=null,I={getAngleDiff:function(t){for(var n=parseInt(y-e.getAngle180(t[0],t[1]),10),r=0;Math.abs(n-P)>90&&r++<50;)0>P?n-=180:n+=180;return P=parseInt(n,10)},pinch:function(o){var s=o.target;if(n.pinch){if(!h)return;if(e.getFingers(o)<2&&!e.isTouchEnd(o))return;var a=e.calScale(i.start,i.move),c=this.getAngleDiff(i.move),u={type:"",originEvent:o,scale:a,rotation:c,direction:c>0?"right":"left",fingersCount:e.getFingers(o)};if(g?e.isTouchMove(o)?(u.fingerStatus="move",t.trigger(s,r.PINCH,u)):e.isTouchEnd(o)&&(u.fingerStatus="end",t.trigger(s,r.PINCH_END,u),e.reset()):(g=!0,u.fingerStatus="start",t.trigger(s,r.PINCH_START,u)),Math.abs(1-a)>n.minScaleRate){var l=e.simpleClone(u);a>m?(m=a-1e-11,t.trigger(s,r.PINCH_OUT,l,!1)):m>a&&(m=a+1e-11,t.trigger(s,r.PINCH_IN,l,!1)),e.isTouchEnd(o)&&(m=1)}if(Math.abs(c)>n.minRotationAngle){var f,p=e.simpleClone(u);f=c>0?r.ROTATION_RIGHT:r.ROTATION_LEFT,t.trigger(s,f,p,!1),t.trigger(s,r.ROTATION,u)}}},rotateSingleFinger:function(n){var o=n.target;if(T&&e.getFingers(n)<2){if(!i.move)return;if(E.length<2){var s=e.getXYByElement(o);E=[{x:s.left+o.offsetWidth/2,y:s.top+o.offsetHeight/2},i.move[0]],y=parseInt(e.getAngle180(E[0],E[1]),10)}var a=[E[0],i.move[0]],c=this.getAngleDiff(a),u={type:"",originEvent:n,rotation:c,direction:c>0?"right":"left",fingersCount:e.getFingers(n)};e.isTouchMove(n)?u.fingerStatus="move":(e.isTouchEnd(n)||"mouseout"===n.type)&&(u.fingerStatus="end",t.trigger(o,r.PINCH_END,u),e.reset());var g=c>0?r.ROTATION_RIGHT:r.ROTATION_LEFT;t.trigger(o,g,u),t.trigger(o,r.ROTATION,u)}},swipe:function(s){var a=s.target;if(h&&i.move&&!(e.getFingers(s)>1)){var c=Date.now()-o,g=e.getDistance(i.start[0],i.move[0]),p={x:i.move[0].x-f.left,y:i.move[0].y-f.top},v=e.getAngle(i.start[0],i.move[0]),d=e.getDirectionFromAngle(v),m=c/1e3,T=10*(10-n.swipeFactor)*m*m,E={type:r.SWIPE,originEvent:s,position:p,direction:d,distance:g,distanceX:i.move[0].x-i.start[0].x,distanceY:i.move[0].y-i.start[0].y,x:i.move[0].x-i.start[0].x,y:i.move[0].y-i.start[0].y,angle:v,duration:c,fingersCount:e.getFingers(s),factor:T};if(n.swipe){var y=function(){var e=r;switch(d){case"up":t.trigger(a,e.SWIPE_UP,E);break;case"down":t.trigger(a,e.SWIPE_DOWN,E);break;case"left":t.trigger(a,e.SWIPE_LEFT,E);break;case"right":t.trigger(a,e.SWIPE_RIGHT,E)}};u?e.isTouchMove(s)?(E.fingerStatus=E.swipe="move",t.trigger(a,r.SWIPING,E),c>n.swipeTime&&c<n.swipeTime+50&&g>n.swipeMinDistance&&(y(),t.trigger(a,r.SWIPE,E,!1))):(e.isTouchEnd(s)||"mouseout"===s.type)&&(E.fingerStatus=E.swipe="end",t.trigger(a,r.SWIPE_END,E),n.swipeTime>c&&g>n.swipeMinDistance&&(y(),t.trigger(a,r.SWIPE,E,!1))):(E.fingerStatus=E.swipe="start",u=!0,t.trigger(a,r.SWIPE_START,E))}n.drag&&(l?e.isTouchMove(s)?(E.fingerStatus=E.swipe="move",t.trigger(a,r.DRAG,E)):e.isTouchEnd(s)&&(E.fingerStatus=E.swipe="end",t.trigger(a,r.DRAGEND,E)):(E.fingerStatus=E.swipe="start",l=!0,t.trigger(a,r.DRAGSTART,E)))}},tap:function(s){var a=s.target;if(n.tap){var c=Date.now(),u=c-o,g=e.getDistance(i.start[0],i.move?i.move[0]:i.start[0]);if(clearTimeout(p),function(){return!!(S&&n.doubleTap&&o-w<n.maxDoubleTapInterval&&16>e.getDistance(S,i.start[0]))}())return clearTimeout(d),void t.trigger(a,r.DOUBLE_TAP,{type:r.DOUBLE_TAP,originEvent:s,position:i.start[0]});if(n.tapMaxDistance<g)return;n.holdTime>u&&e.getFingers(s)<=1&&(v=!0,w=c,S=i.start[0],d=setTimeout(function(){t.trigger(a,r.TAP,{type:r.TAP,originEvent:s,fingersCount:e.getFingers(s),position:S})},n.tapTime))}},hold:function(r){var o=r.target;n.hold&&(clearTimeout(p),p=setTimeout(function(){if(i.start){var s=e.getDistance(i.start[0],i.move?i.move[0]:i.start[0]);n.tapMaxDistance<s||v||t.trigger(o,"hold",{type:"hold",originEvent:r,fingersCount:e.getFingers(r),position:i.start[0]})}},n.holdTime))}},A=function(t){var n=t.target;switch(t.type){case"touchstart":case"mousedown":E=[],h=!0,(!i.start||i.start.length<2)&&(i.start=e.getPosOfEvent(t)),e.getFingers(t)>=2&&(y=parseInt(e.getAngle180(i.start[0],i.start[1]),10)),o=Date.now(),s=t,f={};var r=n.getBoundingClientRect(),a=document.documentElement;f={top:r.top+(window.pageYOffset||a.scrollTop)-(a.clientTop||0),left:r.left+(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0)},I.hold(t);break;case"touchmove":case"mousemove":if(!h||!i.start)return;i.move=e.getPosOfEvent(t),e.getFingers(t)>=2?I.pinch(t):T?I.rotateSingleFinger(t):I.swipe(t);break;case"touchend":case"touchcancel":case"mouseup":case"mouseout":if(!h)return;c=t,g?I.pinch(t):T?I.rotateSingleFinger(t):u?I.swipe(t):I.tap(t),e.reset(),y=0,P=0,t.touches&&1===t.touches.length&&(h=!0,T=!0)}},C=function(){var n,r,i,o,s=arguments;if(s.length<2||s>4)return console.error("unexpected arguments!");var a="string"===e.getType(s[0])?document.querySelectorAll(s[0]):s[0];if(a=a.length?Array.prototype.slice.call(a):[a],3===s.length&&"string"===e.getType(s[1]))return n=s[1].split(" "),r=s[2],void n.forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),a.forEach(function(e){t.bind(e,n,r)})});if(3!==s.length||"object"!==e.getType(s[1]))if(2!==s.length||"object"!==e.getType(s[1])){if(4===s.length&&"object"===e.getType(s[2]))return n=s[1].split(" "),r=s[3],void n.forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),a.forEach(function(e){t.bind(e,n,r)})});if(4===s.length){var c=a[0];return n=s[1].split(" "),o=s[2],r=s[3],void n.forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),t.delegate(c,n,o,r)})}}else{i=s[1];for(var u in i)!function(n){e.hasTouch||(n=e.getPCevts(n)),a.forEach(function(e){t.bind(e,n,i[n])})}(u)}else{i=s[1],o=s[2];for(var g in i)!function(n){e.hasTouch||(n=e.getPCevts(n)),a.forEach(function(e){t.delegate(e,n,o,i[n])})}(g)}},x=function(){var n,r,i=arguments;if(i.length<1||i.length>4)return console.error("unexpected arguments!");var o="string"===e.getType(i[0])?document.querySelectorAll(i[0]):i[0];if(o=o.length?Array.prototype.slice.call(o):[o],1!==i.length&&2!==i.length){if(3===i.length&&"function"===e.getType(i[2]))return r=i[2],void o.forEach(function(o){(n=i[1].split(" ")).forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),t.unbind(o,n,r)})});if(3!==i.length||"string"!==e.getType(i[2]))return 4===i.length?(r=i[3],void o.forEach(function(o){(n=i[1].split(" ")).forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),t.undelegate(o,n,s,r)})})):void 0;var s=i[2];o.forEach(function(r){(n=i[1].split(" ")).forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),t.undelegate(r,n,s)})})}else o.forEach(function(r){(n=i[1]?i[1].split(" "):Object.keys(r.listeners)).length&&n.forEach(function(n){e.hasTouch||(n=e.getPCevts(n)),t.unbind(r,n),t.undelegate(r,n)})})},D=function(n,r,i){var o=arguments;e.hasTouch||(r=e.getPCevts(r));var s="string"===e.getType(o[0])?document.querySelectorAll(o[0]):o[0];(s=s.length?Array.prototype.call(s):[s]).forEach(function(e){t.trigger(e,r,i)})};!function(){(e.hasTouch?"touchstart touchmove touchend touchcancel":"mouseup mousedown mousemove mouseout").split(" ").forEach(function(e){document.addEventListener(e,A,!1)})}();var O={};return O.on=O.bind=O.live=C,O.off=O.unbind=O.die=x,O.config=n,O.trigger=D,O});
//# sourceMappingURL=maps/touch.min.js.map
