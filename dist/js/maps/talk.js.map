{"version":3,"sources":["talk.js"],"names":["talk","$","ajax","type","url","http","dataType","contentType","data","JSON","stringify","userNumber","pageSize","currentPage","success","time","creatTime","result","reverse","str","i","length","createTime","substring","userId","headImg","name","content","html","on","show","parseInt","this","attr","personal","error","add","console","log","talkWord","status","val","gUserInfo","find","win","lose","rank","dan","userNUmber","sessionStorage","getItem","ward","location","href","setItem"],"mappings":"AASA,SAASA,OACRC,EAAEC,MACCC,KAAM,OACRC,IAAKC,KAAO,oBACZC,SAAU,OACVC,YAAa,iCACbC,KAAMC,KAAKC,WACVC,WAAaA,WACbC,SAAY,EACZC,YAAcA,cAEfC,QAAS,SAASN,GAMjB,IAAI,IAFAO,EACAC,EAHAC,EAAOT,EAAKS,OAAOC,UACnBC,EAAI,GAGAC,EAAE,EAAEA,EAAEH,EAAOI,OAAOD,IAG3BJ,GADCD,EAAKE,EAAOG,GAAGE,YACDC,UAAU,EAAER,EAAKM,OAAO,GAEvCF,GAAK,OACLA,GAAK,wBACLA,GAAK,2BACLA,GAAK,yCAAyCF,EAAOG,GAAGI,OAAO,KAC/DL,GAAK,aAAaF,EAAOG,GAAGK,QAAQ,MACpCN,GAAK,SACLA,GAAK,kCAAkCF,EAAOG,GAAGM,KAAK,SACtDP,GAAK,iCAELA,GAAK,oDACLA,GAAK,SACLA,GAAK,qBAAqBH,EAAU,SACpCG,GAAK,SACLA,GAAK,qBAAqBF,EAAOG,GAAGO,QAAQ,SAC5CR,GAAK,SACLA,GAAK,QAINlB,EAAE,YAAY2B,KAAKT,GAEnBlB,EAAE,YAAY4B,GAAG,QAAQ,WACxB5B,EAAE,SAAS6B,OACX7B,EAAE,UAAU6B,OACZN,OAAOO,SAAS9B,EAAE+B,MAAMC,KAAK,WAC7BC,cAIFC,MAAO,eAoBT,SAASC,MACRC,QAAQC,IAAIC,UACZtC,EAAEC,MACDC,KAAM,OACNC,IAAKC,KAAO,wBACZC,SAAU,OACVC,YAAa,iCACbC,KAAMC,KAAKC,WACVC,WAAcA,WACdgB,QAAUY,WAEXzB,QAAS,SAASN,GACjB6B,QAAQC,IAAI9B,GACI,GAAbA,EAAKgC,SACPxC,OAEAC,EAAE,SAASwC,IAAI,QAMnB,SAASP,WACRjC,EAAEC,MACDC,KAAM,OACNC,IAAKC,KAAO,wBACZC,SAAU,OACVC,YAAa,iCACbC,KAAMC,KAAKC,WACVc,OAASA,SAEVV,QAAS,SAASN,GACjB6B,QAAQC,IAAI9B,GACZ,IAAIkC,EAAUlC,EAAKkC,UACnBzC,EAAE,YAAY0C,KAAK,OAAOV,KAAK,MAAMS,EAAUjB,SAC/CxB,EAAE,aAAa2B,KAAKc,EAAUE,KAC9B3C,EAAE,cAAc2B,KAAKc,EAAUG,MAC/B5C,EAAE,cAAc2B,KAAKc,EAAUI,MAC/B7C,EAAE,aAAa2B,KAAKc,EAAUhB,MACZ,MAAfgB,EAAUK,IACN9C,EAAE,WAAWgC,KAAK,MAAM,uBACD,MAAfS,EAAUK,IAClB9C,EAAE,WAAWgC,KAAK,MAAM,sCACD,MAAfS,EAAUK,IAClB9C,EAAE,WAAWgC,KAAK,MAAM,sCACD,MAAfS,EAAUK,IAClB9C,EAAE,WAAWgC,KAAK,MAAM,sCACD,MAAfS,EAAUK,IAClB9C,EAAE,WAAWgC,KAAK,MAAM,sCACD,MAAfS,EAAUK,KAClB9C,EAAE,WAAWgC,KAAK,MAAM,yCAjIlC,IAAIT,OACAX,YAAY,EAEZmC,WAAWC,eAAeC,QAAQ,cAErClD,OA6DD,IAAImD,KAAKF,eAAeC,QAAQ,QAChCjD,EAAE,SAASwC,IAAIU,MAEf,IAAIZ,SAEJtC,EAAE,SAAS4B,GAAG,QAAQ,WACrBU,SAAStC,EAAE,SAASwC,MACpBJ,QAAQC,IAAIC,UAGZH,IAAIG,YA2DLtC,EAAE,aAAa4B,GAAG,QAAQ,WACzBuB,SAASC,KAAK,4BAA4B1C,aAG3CV,EAAE,SAAS4B,GAAG,QAAQ,WACrBuB,SAASC,KAAK,cAGfpD,EAAE,WAAW4B,GAAG,QAAQ,WACvBoB,eAAeK,QAAQ,WAAW9B,QAClC4B,SAASC,KAAK","file":"../talk.js","sourcesContent":["\r\nvar userId;\r\nvar currentPage=1;\r\n//聊天信息\r\nvar userNUmber=sessionStorage.getItem('userNumber');\r\n//setInterval(function(){\r\n\ttalk()\r\n//},2000)\r\n\r\nfunction talk(){\r\n\t$.ajax({\r\n    type: \"post\",\r\n\t\turl: http + \"gUserInfo/getChat\",\r\n\t\tdataType: \"json\",\r\n\t\tcontentType: \"application/json;charset=utf-8\",\r\n\t\tdata: JSON.stringify({\r\n\t\t\t\"userNumber\":userNumber,\r\n\t\t\t\"pageSize\": 4,\r\n\t\t\t\"currentPage\":currentPage\r\n\t\t}),\r\n\t\tsuccess: function(data) {\r\n\t\t\t//console.log(data)\r\n\t\t\tvar result=data.result.reverse();\r\n\t\t\tvar str='';\r\n\t\t\tvar time;\r\n\t\t\tvar creatTime\r\n\t\t\tfor(var i=0;i<result.length;i++){\r\n\t\t\t\t\r\n\t\t\t\t\ttime=result[i].createTime;\r\n\t\t\t\tcreatTime=time.substring(0,time.length-2)\r\n\t\t\t\t//console.log(creatTime)\r\n\t\t\t\tstr+='<li>';\r\n\t\t\t\tstr+='<div class=\"talkBox\">';\r\n\t\t\t\tstr+='<div id=\"talkTop clear\">';\t\r\n\t\t\t\tstr+='<div class=\"talkImg talkLeft\" userId=\"'+result[i].userId+'\">';\r\n\t\t\t\tstr+='<img src=\"'+result[i].headImg+'\"/>';\t\t\t\r\n\t\t\t\tstr+='</div>';\t\t\r\n\t\t\t\tstr+='<div class=\"talkName talkLeft\">'+result[i].name+'</div>';\t\t\r\n\t\t\t\tstr+='<div class=\"talkWin talkLeft\">';\r\n\t\t\t\t\r\n\t\t\t\tstr+='<img src=\"../image/_level_1.png\"/ class=\"winImg\">';\t\t\r\n\t\t\t\tstr+='</div>';\t\t\r\n\t\t\t\tstr+='<div class=\"time\">'+creatTime+'</div>';\t\r\n\t\t\t\tstr+='</div>';\r\n\t\t\t\tstr+='<div class=\"word\">'+result[i].content+'</div>';\r\n\t\t\t\tstr+='</div>';\r\n\t\t\t\tstr+='</li>';\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t$('#thelist').html(str)\t\t\t\r\n\t\t\t/*点击头像*/\r\n\t\t\t$('.talkImg').on('click',function(){\r\n\t\t\t\t$('.mask').show();\r\n\t\t\t\t$('.popup').show();\r\n\t\t\t\tuserId=parseInt($(this).attr('userid'))\r\n\t\t\t\tpersonal();\r\n\t\t\t})\r\n\t\t\t\r\n\t\t},\r\n\t\terror: function() {\r\n\t\t\t\r\n\t\t}\r\n\t})\r\n\r\n}\r\n\r\nvar ward=sessionStorage.getItem('ward');\r\n$('.talk').val(ward);\r\n/*添加信息*/\r\nvar talkWord;\r\n\r\n$('.send').on('click',function(){\r\n\ttalkWord=$('.talk').val();\r\n\tconsole.log(talkWord)\r\n\t\r\n\t\r\n\tadd(talkWord);\r\n\t\r\n})\r\nfunction add(){\r\n\tconsole.log(talkWord)\r\n\t$.ajax({\r\n\t\ttype: \"post\",\r\n\t\turl: http + \"gUserInfo/createGChat\",\r\n\t\tdataType: \"json\",\r\n\t\tcontentType: \"application/json;charset=utf-8\",\r\n\t\tdata: JSON.stringify({\r\n\t\t\t\"userNumber\": userNumber,\r\n\t\t\t\"content\":talkWord\r\n\t\t}),\r\n\t\tsuccess: function(data) {\r\n\t\t\tconsole.log(data)\r\n\t\t\tif(data.status==1){\r\n\t\t\t\ttalk()\r\n\t\t\t\t//sessionStorage.clear()\r\n\t\t\t\t$('.talk').val('')\r\n\t\t\t}\r\n\t\t}\r\n\t\t})\r\n}\r\n/*获取人员信息*/\r\nfunction personal(){\r\n\t$.ajax({\r\n\t\ttype: \"post\",\r\n\t\turl: http + \"gUserInfo/getUserById\",\r\n\t\tdataType: \"json\",\r\n\t\tcontentType: \"application/json;charset=utf-8\",\r\n\t\tdata: JSON.stringify({\r\n\t\t\t\"userId\":userId\r\n\t\t}),\r\n\t\tsuccess: function(data) {\r\n\t\t\tconsole.log(data)\r\n\t\t\tvar gUserInfo=data.gUserInfo;\r\n\t\t\t$('.headImg').find('img').attr('src',gUserInfo.headImg);\r\n\t\t\t$('.winCount').html(gUserInfo.win);\r\n\t\t\t$('.loseCount').html(gUserInfo.lose);\r\n\t\t\t$('.rankCount').html(gUserInfo.rank);\r\n\t\t\t$('.nickName').html(gUserInfo.name)\r\n\t\t\tif(gUserInfo.dan==\"菜鸟\"){\r\n        \t\t$('.winImg').attr('src','../image/shield.png')\r\n        \t}else if(gUserInfo.dan==\"小白\"){\r\n        \t\t$('.winImg').attr('src','../image/ic_kline_flag_level_2.png')\r\n        \t}else if(gUserInfo.dan==\"精英\"){\r\n        \t\t$('.winImg').attr('src','../image/ic_kline_flag_level_3.png')\r\n        \t}else if(gUserInfo.dan==\"大师\"){\r\n        \t\t$('.winImg').attr('src','../image/ic_kline_flag_level_4.png')\r\n        \t}else if(gUserInfo.dan==\"大将\"){\r\n        \t\t$('.winImg').attr('src','../image/ic_kline_flag_level_5.png')\r\n        \t}else if(gUserInfo.dan==\"王者\"){\r\n        \t\t$('.winImg').attr('src','../image/ic_kline_flag_level_6.png')\r\n        \t}\r\n\t\t}\r\n\t\t})\r\n}\r\n/*返回*/\r\n$('.backImg1').on('click',function(){\r\n\tlocation.href=\"../index.html?userNumber=\"+userNumber;\r\n})\r\n/*刷新*/\r\n$('.talk').on('focus',function(){\r\n\tlocation.href=\"text.html\"\r\n})\r\n\r\n$('.hisImg').on('click',function(){\r\n\tsessionStorage.setItem('userName',userId);\r\n\tlocation.href='history.html';\r\n})\r\n\r\n\r\n"]}