{"version":3,"sources":["king.js"],"names":["loaded","pullDownEl","document","getElementById","pullDownOffset","offsetHeight","pullUpEl","pullUpOffset","myScroll","iScroll","useTransition","topOffset","onRefresh","className","match","querySelector","innerHTML","onScrollMove","this","y","minScrollY","maxScrollY","onScrollEnd","pullDownAction","pullUpAction","loadAction","getData","setTimeout","refresh","pageIndex","console","log","page","$","ajax","type","url","http","async","contentType","dataType","data","JSON","stringify","userNumber","pageSize","currentPage","success","listl","i","result","length","rank","headImg","userId","name","dan","integral","win","lose","html","attr","click","index","show","src0","children","content","nid","sessionStorage","setItem","window","location","href","hide","generatedCount","addEventListener"],"mappings":"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","file":"../king.js","sourcesContent":["\t\t\r\n\r\nvar myScroll,pullDownEl, pullDownOffset,pullUpEl, pullUpOffset,generatedCount = 0;  \r\nvar pageIndex=1;\r\n  \r\nfunction loaded() {  \r\n    //动画部分  \r\n    pullDownEl = document.getElementById('pullDown');  \r\n    pullDownOffset = pullDownEl.offsetHeight;  \r\n    pullUpEl = document.getElementById('pullUp');     \r\n    pullUpOffset = pullUpEl.offsetHeight;  \r\n    myScroll = new iScroll('wrapper', {  \r\n        useTransition: true,  \r\n        topOffset: pullDownOffset,  \r\n        onRefresh: function () {  \r\n            if (pullDownEl.className.match('loading')) {  \r\n                pullDownEl.className = '';  \r\n                pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉刷新';  \r\n            } else if (pullUpEl.className.match('loading')) {  \r\n                pullUpEl.className = '';  \r\n                pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多';  \r\n            }  \r\n        },  \r\n        onScrollMove: function () {  \r\n          \r\n            if (this.y > 5 && !pullDownEl.className.match('flip')) {  \r\n                pullDownEl.className = 'flip';  \r\n                pullDownEl.querySelector('.pullDownLabel').innerHTML = '释放刷新';  \r\n                this.minScrollY = 0;  \r\n            } else if (this.y < 5 && pullDownEl.className.match('flip')) {  \r\n                pullDownEl.className = '';  \r\n                pullDownEl.querySelector('.pullDownLabel').innerHTML = 'Pull down to refresh...';  \r\n                this.minScrollY = -pullDownOffset;  \r\n            } else if (this.y < (this.maxScrollY - 5) && !pullUpEl.className.match('flip')) {  \r\n                pullUpEl.className = 'flip';  \r\n                pullUpEl.querySelector('.pullUpLabel').innerHTML = '释放刷新';  \r\n                this.maxScrollY = this.maxScrollY;  \r\n            } else if (this.y > (this.maxScrollY + 5) && pullUpEl.className.match('flip')) {  \r\n                pullUpEl.className = '';  \r\n                pullUpEl.querySelector('.pullUpLabel').innerHTML = 'Pull up to load more...';  \r\n                this.maxScrollY = pullUpOffset;  \r\n            }  \r\n        },  \r\n        onScrollEnd: function () {  \r\n            if (pullDownEl.className.match('flip')) {  \r\n                pullDownEl.className = 'loading';  \r\n                pullDownEl.querySelector('.pullDownLabel').innerHTML = '加载中';                 \r\n                pullDownAction();   // Execute custom function (ajax call?)  \r\n            } else if (pullUpEl.className.match('flip')) {  \r\n                pullUpEl.className = 'loading';  \r\n                pullUpEl.querySelector('.pullUpLabel').innerHTML = '加载中';                 \r\n                pullUpAction(); // Execute custom function (ajax call?)  \r\n            }  \r\n        }  \r\n    });  \r\n      \r\n    loadAction();  \r\n}  \r\n//document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);//阻止冒泡  \r\ndocument.addEventListener('DOMContentLoaded', function () { setTimeout(loaded, 0); }, false);  \r\n  \r\n//初始状态，加载数据  \r\nfunction loadAction(){  \r\n\tgetData(10 );\r\n//\tmyScroll.refresh(); \r\n}  \r\n  \r\n//下拉刷新当前数据  \r\nfunction pullDownAction () {  \r\n    setTimeout(function () {  \r\n        //这里执行刷新操作  \r\n          \r\n        myScroll.refresh();   \r\n    }, 400);  \r\n}  \r\n  \r\n//上拉加载更多数据  \r\nfunction pullUpAction () {  \r\n\tpageIndex++;\r\n\tconsole.log(pageIndex)\r\n    setTimeout(function () {  \r\n    \t\r\n//      getData(4); \r\n        myScroll.refresh();  \r\n    }, 400);  \r\n}  \r\n\r\nfunction getData(page){\r\n\t//从后台获取数据\r\n\t$.ajax({\r\n\t\ttype:\"post\",\r\n\t\turl: http + \"gUserInfo/getUserInfo\",\r\n\t\tasync:true,\r\n\t\tcontentType:'application/json;charset=utf-8',\r\n\t\tdataType:'json',\r\n\t\tdata:JSON.stringify({\r\n\t\t\t\"userNumber\":userNumber,\r\n\t\t\t\"pageSize\":page,\r\n\t\t\t\"currentPage\":pageIndex\r\n\t\t}),\r\n\t\tsuccess:function(data){\r\n\t\t\tconsole.log(data);\r\n\t\t\tvar listl = '';\r\n\t\t\tfor(var i=0;i<data.result.length;i++){\r\n//\t\t\t\tvar rank = data.result[i].rank + page - 1;\r\n\t\t\t\tlistl +=    '<li class=\"list-l1\">'+\r\n\t\t\t\t\t\t\t\t'<span class=\"place fl\">'+data.result[i].rank+'</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"img fl\"><img src=\"'+data.result[i].headImg+'\"/></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"write fl\" nid=\"'+data.result[i].userId+'\">'+data.result[i].name+'</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"icon fl\"><img /></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"grad fl\">'+data.result[i].dan+'</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"total fl\">'+data.result[i].integral+'</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"win fl\"><img src=\"../image/ic_circle_box_game_bg_win.png\"/></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"win-num fl\">'+data.result[i].win+'</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"lose fl\"><img src=\"../image/ic_kline_src_lose.png\"/></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"lose-num fl\">'+data.result[i].lose+'</span>'+\r\n\t\t\t\t\t\t\t'</li>'\r\n\t\t\t\t$('.head-list').html(listl);\r\n\t\t\t\t//判断段位放入对应图片\r\n\t\t\t\tif(data.result[i].dan==\"菜鸟\"){\r\n\t\t\t\t\t$('.list-l1 .icon img').attr(\"src\",\"../image/ic_kline_flag_level_1.png\")\r\n\t\t\t\t}else if(data.result[i].dan==\"小白\"){\r\n\t\t\t\t\t$('.list-l1 .icon img').attr(\"src\",\"../image/ic_kline_flag_level_2.png\")\r\n\t\t\t\t}else if(data.result[i].dan==\"精英\"){\r\n\t\t\t\t\t$('.list-l1 .icon img').attr('src','../image/ic_kline_flag_level_3.png')\r\n\t\t\t\t}else if(data.result[i].dan==\"大师\"){\r\n\t\t\t\t\t$('.list-l1 .icon img').attr('src','../image/ic_kline_flag_level_4.png')\r\n\t\t\t\t}else if(data.result[i].dan==\"大将\"){\r\n\t\t\t\t\t$('.list-l1 .icon img').attr('src','../image/ic_kline_flag_level_5.png')\r\n\t\t\t\t}else if(data.result[i].dan==\"王者\"){\r\n\t\t\t\t\t$('.list-l1 .icon img').attr('src','../image/ic_kline_flag_level_6.png')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//数据获取成功之后点击弹框出现\r\n\t\t\t$('.list-l1').click(function(){\r\n\t\t\t\tconsole.log($(this).index())\r\n\t\t\t\t$('.mask,.popup').show();\t\t\t\t\t\r\n\t\t\t\t//弹框内容 在页面加载成功之后获取当前数据\r\n\t//\t\t\tconsole.log($(this).children('.img').children('img').attr('src'))\r\n\t\t\t\tvar src0 = $(this).children('.img').children('img').attr('src');\t\r\n\t\t\t\tvar content = '';//弹框内容\r\n\t\t\t\tcontent += '<div class=\"con-left fl\">'+\r\n\t\t\t\t\t\t\t\t'<span class=\"img fl\"><img /></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"write fl\"></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"win fl\"><img src=\"../image/ic_circle_box_game_bg_win.png\"/></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"win-num fl\">胜：</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"lose fl\"><img src=\"../image/ic_kline_src_lose.png\"/></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"lose-num fl\">负：</span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"history fl\"><img src=\"../image/history.png\"/></span>'+\r\n\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t'<div class=\"con-right fl\">'+\r\n\t\t\t\t\t\t\t\t'<span class=\"icon fl\"></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"grad fl\"></span>'+\r\n\t\t\t\t\t\t\t\t'<span class=\"place\">总排名：</span>'+\r\n\t\t\t\t\t\t\t'</div>'\t\t\t\t\t\t\r\n\t\t\t\t$('.content').html(content);\r\n\t\t\t\t//获取每条数据内容\r\n\t\t\t\t$('.con-left .img img').attr(\"src\",src0);\r\n\t\t\t\t$('.con-left .write').html($(this).children('.write').html());\r\n\t\t\t\t$('.con-left .win-num').html('胜：'+$(this).children('.win-num').html());\r\n\t\t\t\t$('.con-left .lose-num').html('负：'+$(this).children('.lose-num').html());\r\n\t\t\t\t$('.con-right .grad').html($(this).children('.grad').html());\r\n\t\t\t\t$('.con-right .place').html('总排名：'+$(this).children('.place').html());\r\n\t\t\t\t$('.con-right .icon').html($('.list-l1 .icon').html());\r\n\t\t\t\tvar nid = $(this).children('.write').attr('nid');\r\n\t\t\t\tconsole.log(nid)\r\n\t//\t\t\tconsole.log($('.list-l1 .icon').html())\r\n\t\t\t\t//点击跳转历史战绩  并且保存用户名\t\t\t\r\n\t\t\t\t$('.history').click(function(){\t\t\t\t\r\n\t\t\t\t\tsessionStorage.setItem('userId',nid);\r\n\t\t\t\t\twindow.location.href = 'history.html'\r\n\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t})\r\n\t\t\t//点击X关闭弹框\r\n\t\t\t$('.close').click(function(){\r\n\t\t\t\t$('.mask,.popup').hide();\r\n\t\t\t})\r\n\t\t\t\r\n\t\t}\r\n\t});\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}